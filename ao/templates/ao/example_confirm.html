<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>予約確認</title>
    <style>
        body {
            font-family: 'Arial', 'Hiragino Sans', 'Meiryo', sans-serif;
            background-color: #fff8f8;
            margin: 0;
            padding: 20px;
            color: #333;
            line-height: 1.6;
        }
    
        h1 {
            text-align: center;
            color: #800000;
            padding-bottom: 15px;
            border-bottom: 2px solid #800000;
            margin-bottom: 30px;
        }
    
        div {
            background-color: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(128, 0, 0, 0.1);
            max-width: 800px;
            margin: 0 auto;
        }
    
        p {
            margin: 12px 0;
            padding: 8px 0;
            border-bottom: 1px dashed #e0c0c0;
        }
    
        p:last-child {
            border-bottom: none;
        }
    
        ul {
            padding-left: 20px;
            margin: 15px 0;
        }
    
        li {
            margin-bottom: 8px;
            color: #800000;
        }
    
        .button-container {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
    
        button {
            background-color: #800000;
            color: #fff;
            padding: 12px 25px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            font-weight: bold;
            letter-spacing: 1px;
        }
    
        button:hover {
            background-color: #a00000;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(128, 0, 0, 0.2);
        }
    
        .button-secondary {
            background-color: #555;
        }
    
        .button-secondary:hover {
            background-color: #777;
            box-shadow: 0 4px 8px rgba(85, 85, 85, 0.2);
        }
    
        #totalAmount, #pricePerPerson {
            font-weight: bold;
            color: #800000;
            font-size: 1.1em;
        }
    
        span[id$="date"] {
            font-weight: bold;
            color: #800000;
        }
    </style>
</head>
<body>
    <h1>予約内容確認</h1>

    <div>
        <p>チェックイン日: <span id="check_in_date">{{ data.check_in_date }}</span></p>
        <p>チェックアウト日: <span id="check_out_date">{{ data.check_out_date }}</span></p>
        <p>名前: {{ data.name }}</p>
        <p>ふりがな: {{ data.furigana }}</p>
        <p>男性人数: <span id="men">{{ data.men }}</span></p>
        <p>女性人数: <span id="women">{{ data.women }}</span></p>
        <p>メール: {{ data.email }}</p>
        <p>電話番号: {{ data.phone_number }}</p>
        <p>郵便番号: {{ data.postal_code }}</p>
        <p>住所: {{ data.address }}</p>
    
        <p>追加オプション</p>
        <ul>
            {% if data.yakiniku %}
            <li>焼肉セット: <span id="yakiniku">{{ data.yakiniku }}</span>セット</li>
            {% endif %}
            {% if data.games %}<li>ゲーム・漫画セット</li>{% endif %}
            {% if data.others %}<li>その他（カヌー）など</li>{% endif %}
        </ul>

        <p></p>
        <p>ご要望: {{ data.messages }}</p>
        <p>合計金額: <span id="totalAmount">{{ total_amount|floatformat:"0" }}</span>円（税込）</p>
        <p>一人当たり金額: <span id="pricePerPerson">{{ pricePerPerson|floatformat:"0" }}</span>円（税込）</p>

        <div class="button-container">
            <!-- 予約確定ボタン -->
            <form method="post" action="{% url 'example_confirm' %}" style="margin: 0;">
                {% csrf_token %}
                {% for key, value in data.items %}
                <input type="hidden" name="{{ key }}" value="{{ value }}">
                {% endfor %}
                <button type="submit">予約確定</button>
            </form>
            <!-- 修正するボタン -->
            <form method="post" action="{% url 'example_fix' %}" style="margin: 0;">
                {% csrf_token %}
                {% for key, value in data.items %}
                <input type="hidden" name="{{ key }}" value="{{ value }}">
                {% endfor %}
                <button type="submit" class="button-secondary">修正する</button>
            </form>
        </div>
    
    <script>
    function calculateTotal() {
        const basePrice = 20000;               // 基本料金
        const extraPricePerPerson = 2000;      // 追加料金/人
        const yakinikuPrice = 2500;           // 焼肉セット料金
        const depositPrice = 2000;             // デポジット料金

        // 宿泊人数と焼肉セット数を取得
        const men = parseInt(document.getElementById('men').textContent) || 0;
        const women = parseInt(document.getElementById('women').textContent) || 0;
        const yakinikuSets = parseInt(document.getElementById('yakiniku')?.textContent) || 0;

        // 宿泊日数計算
        const checkInDate = new Date(document.getElementById('check_in_date').textContent);
        const checkOutDate = new Date(document.getElementById('check_out_date').textContent);
        const timeDiff = checkOutDate - checkInDate;
        const days = Math.max(1, timeDiff / (1000 * 60 * 60 * 24));  // 1泊2日は1日として計算

        // 合計金額計算
        const peopleTotal = men + women;
        const totalAmount = (basePrice + extraPricePerPerson * peopleTotal) * days 
                          + yakinikuPrice * yakinikuSets ;
        const pricePerPerson = totalAmount/peopleTotal;

        // 合計金額を表示
        document.getElementById('totalAmount').textContent = `${Math.round(totalAmount).toLocaleString()}`;
        document.getElementById('pricePerPerson').textContent = `${Math.round(pricePerPerson).toLocaleString()}`;
    }

    // ページ読み込み時に計算を実行
    window.addEventListener('DOMContentLoaded', calculateTotal);
    </script>
</body>
</html>







