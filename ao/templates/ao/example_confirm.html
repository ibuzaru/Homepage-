<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å±±è˜ã‚¢ã‚ª</title>
    <style>
        body {
            font-family: 'Arial', 'Hiragino Sans', 'Meiryo', sans-serif;
            background-color: #fff8f8;
            margin: 0;
            padding: 20px;
            color: #333;
            line-height: 1.6;
        }
    
        h1 {
            text-align: center;
            color: #800000;
            padding-bottom: 15px;
            border-bottom: 2px solid #800000;
            margin-bottom: 30px;
        }
    
        div {
            background-color: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(128, 0, 0, 0.1);
            max-width: 800px;
            margin: 0 auto;
        }
    
        p {
            margin: 12px 0;
            padding: 8px 0;
            border-bottom: 1px dashed #e0c0c0;
        }
    
        p:last-child {
            border-bottom: none;
        }
    
        ul {
            padding-left: 20px;
            margin: 15px 0;
        }
    
        li {
            margin-bottom: 8px;
            color: #800000;
        }
    
        .button-container {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
    
        button {
            background-color: #800000;
            color: #fff;
            padding: 12px 25px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            font-weight: bold;
            letter-spacing: 1px;
        }
    
        button:hover {
            background-color: #a00000;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(128, 0, 0, 0.2);
        }
    
        .button-secondary {
            background-color: #555;
        }
    
        .button-secondary:hover {
            background-color: #777;
            box-shadow: 0 4px 8px rgba(85, 85, 85, 0.2);
        }
    
        #totalAmount, #pricePerPerson {
            font-weight: bold;
            color: #800000;
            font-size: 1.1em;
        }
    
        span[id$="date"] {
            font-weight: bold;
            color: #800000;
        }



        .important-notice {
    background: #f8f9fa;         /* èƒŒæ™¯è‰² */
    border: 2px solid #d9534f;   /* èµ¤ç³»ã®æ ç·š */
    border-radius: 10px;         /* è§’ä¸¸ */
    padding: 25px;
    margin: 20px 0;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); /* è»½ã„å½± */
    font-family: Arial, sans-serif;
    line-height: 1.8;
}

.important-notice h2 {
    font-size: 24px;
    color: #d9534f;              /* èµ¤ç³»ã®ã‚¿ã‚¤ãƒˆãƒ« */
    margin-bottom: 15px;
}

.important-notice ul {
    list-style: none;
    padding: 0;
}

.important-notice li {
    margin-bottom: 20px;
    padding-left: 30px;
    position: relative;
    font-size: 18px;
}

.important-notice li::before {
    content: "âœ”";                /* ãƒã‚§ãƒƒã‚¯ãƒãƒ¼ã‚¯ */
    position: absolute;
    left: 0;
    color: #5cb85c;              /* ç·‘è‰² */
    font-size: 20px;
}

.important-notice strong {
    font-size: 20px;
    color: #333;                  /* å¤ªå­—ã§å¼·èª¿ */
}
.detail-box {
    text-align: center;
    margin-top: 20px;
}

.detail-button {
    display: inline-block;
    padding: 12px 30px;
    font-size: 16px;
    font-weight: bold;
    color: #af6c6c;
    border: 1px solid #af6c6c;
    border-radius: 30px;
    text-decoration: none;
    transition: all 0.3s ease-in-out;
}

.detail-button:hover {
    background-color: #af6c6c;
    color: white;
}
    </style>
</head>
<body>
    <h1>äºˆç´„å†…å®¹ç¢ºèª</h1>

    <div>
        <p>ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æ—¥: <span id="check_in_date">{{ data.check_in_date }}</span></p>
        <p>ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆæ—¥: <span id="check_out_date">{{ data.check_out_date }}</span></p>
        <p>åå‰: {{ data.name }}</p>
        <p>ãµã‚ŠãŒãª: {{ data.furigana }}</p>
        <p>ç”·æ€§äººæ•°: <span id="men">{{ data.men }}</span></p>
        <p>å¥³æ€§äººæ•°: <span id="women">{{ data.women }}</span></p>
        <p>ãƒ¡ãƒ¼ãƒ«: {{ data.email }}</p>
        <p>é›»è©±ç•ªå·: {{ data.phone_number }}</p>
        <p>éƒµä¾¿ç•ªå·: {{ data.postal_code }}</p>
        <p>ä½æ‰€: {{ data.address }}</p>
    
        <p>è¿½åŠ ã‚ªãƒ—ã‚·ãƒ§ãƒ³</p>
        <ul>
            {% if data.yakiniku %}
            <li>ç„¼è‚‰ã‚»ãƒƒãƒˆ: <span id="yakiniku">{{ data.yakiniku }}</span>ã‚»ãƒƒãƒˆ</li>
            {% endif %}
            {% if data.maki %}
            <li>è–ª: <span id="maki">{{ data.maki }}</span>æŸ</li>
            {% endif %}
            {% if data.soumen %}<li>æµã—ãã†ã‚ã‚“ã‚»ãƒƒãƒˆï¼ˆç„¡æ–™ï¼‰</li>{% endif %}
            <!--{% if data.games %}<li>ã‚²ãƒ¼ãƒ ãƒ»æ¼«ç”»ã‚»ãƒƒãƒˆ</li>{% endif %}
           {% if data.others %}<li>ãã®ä»–ï¼ˆã‚«ãƒŒãƒ¼ï¼‰ãªã©</li>{% endif %}!-->
        </ul>

        <p></p>
        <p>ã”è¦æœ›: {{ data.messages }}</p>
        <p>åˆè¨ˆé‡‘é¡: <span id="totalAmount">{{ total_amount|floatformat:"0" }}</span>å††ï¼ˆç¨è¾¼ï¼‰</p>
        <p>ä¸€äººå½“ãŸã‚Šé‡‘é¡: <span id="pricePerPerson">{{ pricePerPerson|floatformat:"0" }}</span>å††ï¼ˆç¨è¾¼ï¼‰</p>

        <div class="important-notice">
            <h2>ğŸ“Œ é‡è¦äº‹é …ã¾ã¨ã‚</h2>
            <ul>
                <li>
                    <strong>ğŸ›ï¸ ã‚·ãƒ¼ãƒ„è¨­ç½®ãƒ»ç‰‡ä»˜ã‘</strong><br>
                    ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ãƒ»ã‚¢ã‚¦ãƒˆæ™‚ã«ãŠå®¢æ§˜ã”è‡ªèº«ã§ãŠé¡˜ã„è‡´ã—ã¾ã™ã€‚<br>
                    ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æ™‚ã«ã‚¹ã‚¿ãƒƒãƒ•ãŒã”èª¬æ˜ã„ãŸã—ã¾ã™ã®ã§ã€ã”å”åŠ›ãŠé¡˜ã„è‡´ã—ã¾ã™ã€‚
                    <div class="detail-box">
                        <a href="{% url 'howtostay' %}" class="detail-button">ã”åˆ©ç”¨ã‚¬ã‚¤ãƒ‰</a>
                    </div>
                </li>
                <li>
                    <strong>ğŸ½ï¸ ãŠé£Ÿäº‹ãƒ»ãŠæ–™ç†ã‚»ãƒƒãƒˆ</strong><br>
                    â€»é£Ÿæã¨èª¿å‘³æ–™ã€ç´™çš¿ã¯ãŠè²·ã„æ±‚ã‚ãã ã•ã„ã€‚
                    <br>èª¿ç†å™¨å…·ãªã©ã¯ãã‚ã£ã¦ãŠã‚Šã¾ã™ã€‚
                    <div class="detail-box">
                        <a href="{% url 'rooms' %}" class="detail-button">æ–½è¨­ãƒ»ã”ç”¨æ„å“</a>
                    </div>
                </li>
            </ul>
        </div>

        <div class="button-container">
            <!-- äºˆç´„ç¢ºå®šãƒœã‚¿ãƒ³ã®ãƒ•ã‚©ãƒ¼ãƒ  -->
            <form method="post" action="{% url 'example_confirm' %}" style="margin: 0;" id="confirm-form">
                {% csrf_token %}
                {% for key, value in data.items %}
                    {% if key == 'games' or key == 'others' %}
                        <input type="hidden" name="{{ key }}" value="{% if value == 'on' or value == True %}on{% else %}off{% endif %}">
                    {% else %}
                        <input type="hidden" name="{{ key }}" value="{{ value }}">
                    {% endif %}
                {% endfor %}

                <button type="submit" id="submit-button">äºˆç´„ç¢ºå®š</button>
            </form>
            <!-- ä¿®æ­£ã™ã‚‹ãƒœã‚¿ãƒ³ -->
            <form method="post" action="{% url 'example_fix' %}" style="margin: 0;" id="fix-form"> {% csrf_token %}
                {% for key, value in data.items %}
                    {% if key == 'soumen' or key == 'games' or key == 'others' %}
                        <input type="hidden" name="{{ key }}" value="{% if value == 'on' or value == True %}on{% else %}off{% endif %}">
                    {% else %}
                        <input type="hidden" name="{{ key }}" value="{{ value }}">
                    {% endif %}
                {% endfor %}

                <button type="submit" class="button-secondary" id="fix-button">ä¿®æ­£ã™ã‚‹</button>
            </form>
        </div>
    
    <script>
    function calculateTotal() {
        const basePrice = 10000;               // åŸºæœ¬æ–™é‡‘
        const extraPricePerPerson = 3000;      // è¿½åŠ æ–™é‡‘/äºº
        const yakinikuPrice = 1000;           // ç„¼è‚‰ã‚»ãƒƒãƒˆæ–™é‡‘
        const makiPrice = 500;   //è–ª

        // å®¿æ³Šäººæ•°ã¨ç„¼è‚‰ã‚»ãƒƒãƒˆæ•°ã‚’å–å¾—
        const men = parseInt(document.getElementById('men').textContent) || 0;
        const women = parseInt(document.getElementById('women').textContent) || 0;
        const yakinikuSets = parseInt(document.getElementById('yakiniku')?.textContent) || 0;
        const makis  = parseInt(document.getElementById('maki')?.textContent) || 0;
        // å®¿æ³Šæ—¥æ•°è¨ˆç®—
        const checkInDate = new Date(document.getElementById('check_in_date').textContent);
        const checkOutDate = new Date(document.getElementById('check_out_date').textContent);
        const timeDiff = checkOutDate - checkInDate;
        const days = Math.max(1, timeDiff / (1000 * 60 * 60 * 24));  // 1æ³Š2æ—¥ã¯1æ—¥ã¨ã—ã¦è¨ˆç®—

        // åˆè¨ˆé‡‘é¡è¨ˆç®—
        const peopleTotal = men + women;
        const totalAmount = (basePrice + extraPricePerPerson * peopleTotal) * days 
                          + yakinikuPrice * yakinikuSets + makiPrice * makis ;
        const pricePerPerson = totalAmount/peopleTotal;

        // åˆè¨ˆé‡‘é¡ã‚’è¡¨ç¤º
        document.getElementById('totalAmount').textContent = `${Math.round(totalAmount).toLocaleString()}`;
        document.getElementById('pricePerPerson').textContent = `${Math.round(pricePerPerson).toLocaleString()}`;
    }



    // --- ä¿®æ­£å¾Œã®JavaScript ---

    // 1. å¯¾è±¡ã¨ãªã‚‹è¦ç´ ã‚’ã™ã¹ã¦å–å¾—
    const confirmForm = document.getElementById('confirm-form');
    const submitButton = document.getElementById('submit-button');
    const fixForm = document.getElementById('fix-form');
    const fixButton = document.getElementById('fix-button');

    /**
     * 2. ä¸¡æ–¹ã®ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹å…±é€šã®é–¢æ•°
     * @param {Event} event - ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ™‚ã«ç™ºç”Ÿã—ãŸã‚¤ãƒ™ãƒ³ãƒˆ
     */
    function handleFormSubmit(event) {
        // ä¸¡æ–¹ã®ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
        if (submitButton) {
            submitButton.disabled = true;
        }
        if (fixButton) {
            fixButton.disabled = true;
        }

        // ã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸãƒœã‚¿ãƒ³ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã€Œå‡¦ç†ä¸­...ã€ã«å¤‰æ›´
        // event.currentTarget ã¯ã‚¤ãƒ™ãƒ³ãƒˆãŒè¨­å®šã•ã‚ŒãŸè¦ç´ ï¼ˆã“ã®å ´åˆã¯ãƒ•ã‚©ãƒ¼ãƒ ï¼‰ã‚’æŒ‡ã™
        const clickedButton = event.currentTarget.querySelector('button[type="submit"]');
        if (clickedButton) {
            clickedButton.innerText = 'å‡¦ç†ä¸­...';
        }
    }

    // 3. å„ãƒ•ã‚©ãƒ¼ãƒ ã®é€ä¿¡ã‚¤ãƒ™ãƒ³ãƒˆã«å…±é€šã®é–¢æ•°ã‚’å‰²ã‚Šå½“ã¦
    if (confirmForm) {
        confirmForm.addEventListener('submit', handleFormSubmit);
    }
    if (fixForm) {
        fixForm.addEventListener('submit', handleFormSubmit);
    }


    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«è¨ˆç®—ã‚’å®Ÿè¡Œ
    window.addEventListener('DOMContentLoaded', calculateTotal);
    </script>
</body>
</html>







